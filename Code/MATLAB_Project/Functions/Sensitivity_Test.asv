clc
clear all
close all

Key = {'total_time', 'tau'};

N_o = 15;

pd_o = makedist('Normal','mu',8,'sigma',2);

trunc_o = truncate(pd_o, 0, inf);

x = linspace(1,N_o,N_o);

w_s_o = pdf(trunc_o,x)/sum(pdf(trunc_o,x));

% Epidemiological and Inference parameters

total_time = 20:1:200;

tau = 1:1:8;

w_control = w_s_o;

switch_behaviour = 40;

delay = 0;

update_behaviour = switch_behaviour + delay;

para_o = struct('seed', 1, 'total_time', total_time, 'w_s_all_actual', w_control, 'w_s_all_recorded', w_control, 'switch_behaviour', switch_behaviour, 'update_behaviour', update_behaviour, 'tau', tau, 'a', 1, 'b', 5, 'I_0', 10);

R_start = 10;

R_end = 0.6;

days = 0:1:total_time(1);

para_Linear_Vary = struct('R_t',R_start + (R_end(1)-R_start(1))*days/total_time(1));

[idx1, idx2] = Sensitivity_Analysis(Key, para_o, para_Linear_Vary)
